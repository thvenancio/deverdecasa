<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Hist√≥ria do Brasil ‚Äì Quiz estilo Duolingo</title>
<style>
  :root{
    --bg:#0f172a;          /* slate-900 */
    --card:#111827;        /* gray-900 */
    --muted:#94a3b8;       /* slate-400 */
    --text:#e5e7eb;        /* gray-200 */
    --brand:#22c55e;       /* green-500 */
    --brand-2:#06b6d4;     /* cyan-500 */
    --wrong:#ef4444;       /* red-500 */
    --right:#22c55e;       /* green-500 */
    --warn:#f59e0b;        /* amber-500 */
    --shadow: 0 20px 50px rgba(0,0,0,.35);
    --radius: 18px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;background: radial-gradient(1200px 800px at 50% -10%, #1f2a44 0%, #0b1224 50%, var(--bg) 100%);
    font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
    color:var(--text); display:grid; place-items:center; padding:18px;
  }
  .app{
    width:min(820px,100%); max-width:100%;
  }
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
    border:1px solid rgba(255,255,255,.08);
    border-radius:var(--radius); box-shadow:var(--shadow);
    overflow:hidden;
  }
  header{
    padding:18px 20px; display:flex; gap:12px; align-items:center; justify-content:space-between;
    background:linear-gradient(90deg, rgba(34,197,94,.12), rgba(6,182,212,.12));
    border-bottom:1px solid rgba(255,255,255,.08);
  }
  .title{
    font-weight:800; letter-spacing:.3px; display:flex; gap:10px; align-items:center;
  }
  .badge{
    background:rgba(6,182,212,.15); color:#a7f3d0; padding:4px 10px; border-radius:999px; font-weight:700; font-size:.75rem;
  }
  .progress{
    width:42%; height:10px; background:rgba(255,255,255,.08); border-radius:999px; overflow:hidden;
  }
  .progress>div{height:100%; width:0%; background:linear-gradient(90deg, var(--brand), var(--brand-2)); transition:width .35s ease;}
  main{padding:20px; display:grid; gap:16px;}
  .question{
    font-size:1.25rem; line-height:1.45; font-weight:700;
    background:rgba(255,255,255,.04); padding:16px; border-radius:14px; border:1px solid rgba(255,255,255,.06);
  }
  .options{display:grid; gap:12px;}
  .btn{
    width:100%; text-align:left; padding:14px 16px; border-radius:14px; border:1px solid rgba(255,255,255,.08);
    background:rgba(255,255,255,.03); color:var(--text); cursor:pointer; font-weight:600; transition:.2s transform, .2s background, .2s border;
  }
  .btn:hover{transform:translateY(-1px); background:rgba(255,255,255,.06)}
  .btn[disabled]{opacity:.8; cursor:not-allowed; transform:none}
  .btn.correct{border-color: rgba(34,197,94,.7); background:rgba(34,197,94,.12)}
  .btn.wrong{border-color: rgba(239,68,68,.7); background:rgba(239,68,68,.12)}
  .feedback{
    padding:14px 16px; border-radius:14px; display:none; gap:8px; border:1px dashed rgba(255,255,255,.15);
  }
  .feedback.show{display:flex}
  .feedback.ok{background:rgba(34,197,94,.12); border-color:rgba(34,197,94,.35)}
  .feedback.no{background:rgba(239,68,68,.12); border-color:rgba(239,68,68,.35)}
  .actions{display:flex; gap:10px; justify-content:flex-end}
  .primary{
    padding:12px 16px; border-radius:12px; border:0; color:#062a23; background:linear-gradient(90deg, var(--brand), var(--brand-2)); font-weight:800; cursor:pointer;
  }
  .primary:disabled{opacity:.6; cursor:not-allowed}
  .muted{color:var(--muted); font-size:.95rem}
  footer{
    padding:12px 20px; display:flex; align-items:center; justify-content:space-between; color:var(--muted);
    border-top:1px solid rgba(255,255,255,.08); background:rgba(255,255,255,.02)
  }
  .pill{padding:6px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.15); color:#a5b4fc; font-weight:700; font-size:.8rem}
  .end h2{margin:0 0 8px 0}
  .grid-2{display:grid; gap:10px; grid-template-columns:repeat(2,minmax(0,1fr))}
  @media (max-width:640px){
    header{flex-direction:column; align-items:flex-start; gap:10px}
    .progress{width:100%}
    .grid-2{grid-template-columns:1fr}
    .question{font-size:1.1rem}
  }
</style>
</head>
<body>
<div class="app">
  <div class="card">
    <header>
      <div class="title">üáßüá∑ Quiz ‚Ä¢ Hist√≥ria do Brasil <span class="badge">4¬∫ ano</span></div>
      <div class="progress" aria-label="progresso"><div id="bar"></div></div>
      <div class="pill" id="scorePill">0 acertos</div>
    </header>

    <main>
      <div id="qwrap">
        <div class="question" id="question">Carregando‚Ä¶</div>
        <div class="options" id="options"></div>

        <div id="feedback" class="feedback" role="alert"></div>
        <div class="actions">
          <button id="nextBtn" class="primary" disabled>Pr√≥xima ‚ñ∂</button>
        </div>
        <div class="muted" id="counter"></div>
      </div>

      <div id="end" class="end" style="display:none">
        <h2>üéâ Parab√©ns!</h2>
        <p id="finalText"></p>
        <div class="grid-2">
          <button class="primary" onclick="restart()">Refazer o quiz</button>
          <button class="primary" onclick="share()">Compartilhar resultado</button>
        </div>
        <p class="muted" style="margin-top:10px">Dica: refa√ßa e tente melhorar sua pontua√ß√£o!</p>
      </div>
    </main>

    <footer>
      <div>Conte√∫do: engenhos, Brasil Holand√™s, bandeirantes, gado, ciclo do ouro, Conjura√ß√£o, Revolu√ß√£o Francesa e Napole√£o.</div>
      <div class="pill" id="progressPill">1 / 60</div>
    </footer>
  </div>
</div>

<script>
/* =========================
   Banco de Quest√µes (60)
   Cada item: {q, options:[], answer:index, exp:""}
   ========================= */
const QUESTIONS = [
  // 1-15 Cana/Engenhos
  {q:"A cana-de-a√ß√∫car tem origem em qual regi√£o do mundo?", options:["Nova Guin√© (Oceania)","Pen√≠nsula Ib√©rica","√Åfrica do Norte","Am√©rica Central"], answer:0, exp:"A cana surgiu na Nova Guin√© e foi difundida para √çndia, China, P√©rsia e S√≠ria antes de chegar √† Europa."},
  {q:"Quem ensinou os portugueses a cultivar a cana e produzir a√ß√∫car?", options:["Povos do Oriente","Espanh√≥is","Ind√≠genas brasileiros","Vikings"], answer:0, exp:"Os povos do Oriente j√° dominavam o cultivo; os portugueses aprenderam com eles."},
  {q:"Como se chamava a propriedade onde se plantava cana e produzia a√ß√∫car?", options:["Engenho de a√ß√∫car","Fazenda de mandioca","Sesmeiro","Capitania"], answer:0, exp:"Engenho √© o conjunto produtivo: canaviais, moendas, casas e pessoas."},
  {q:"O primeiro engenho do Brasil foi instalado em:", options:["S√£o Vicente (SP)","Salvador (BA)","Recife (PE)","Rio de Janeiro (RJ)"], answer:0, exp:"Martim Afonso de Sousa instalou o primeiro engenho na capitania de S√£o Vicente."},
  {q:"As capitanias que mais se destacaram na produ√ß√£o de a√ß√∫car foram:", options:["Pernambuco e Bahia","Santa Catarina e Paran√°","Acre e Amap√°","Goi√°s e Tocantins"], answer:0, exp:"Pernambuco e Bahia se destacaram em qualidade e quantidade."},
  {q:"Por que muitos donat√°rios pediam empr√©stimos a comerciantes holandeses?", options:["Porque montar um engenho custava caro","Porque o a√ß√∫car n√£o tinha valor","Porque era proibido plantar cana","Porque n√£o havia m√£o de obra"], answer:0, exp:"A estrutura era car√≠ssima; os holandeses financiavam e comercializavam o a√ß√∫car na Europa."},
  {q:"O territ√≥rio do Brasil foi dividido em grandes √°reas entregues a donat√°rios. Como se chamavam?", options:["Capitanias heredit√°rias","Prov√≠ncias Unidas","Capitais","Estados"], answer:0, exp:"As capitanias eram administradas pelos donat√°rios."},
  {q:"Qual condi√ß√£o natural N√ÉO favorecia o cultivo da cana no Brasil?", options:["Clima frio de montanha","Solos f√©rteis","Regime de chuvas","Grande extens√£o territorial"], answer:0, exp:"Clima frio de montanha n√£o favorece a cana; o Brasil tinha clima e solos favor√°veis."},
  {q:"O a√ß√∫car era t√£o valioso que podia ser:", options:["Presente entre reis e heran√ßa","Usado como moeda somente no Brasil","Proibido em Portugal","Descartado nos navios"], answer:0, exp:"Fontes registram o a√ß√∫car como presente e at√© heran√ßa."},
  {q:"Quem instalou o primeiro engenho no Brasil?", options:["Martim Afonso de Sousa","Maur√≠cio de Nassau","Tiradentes","Dom Sebasti√£o"], answer:0, exp:"Martim Afonso foi o respons√°vel em S√£o Vicente."},
  {q:"Engenho de a√ß√∫car envolve:", options:["Terra, instala√ß√µes, trabalhadores e moendas","Apenas o canavial","Somente a casa-grande","Apenas com√©rcio com a Europa"], answer:0, exp:"√â um complexo produtivo completo."},
  {q:"Os portugueses iniciaram o cultivo de cana em ilhas do Atl√¢ntico, como:", options:["Madeira, A√ßores e Cabo Verde","Ilhas Gal√°pagos","Bermudas","Hava√≠"], answer:0, exp:"Essas ilhas foram etapas antes do Brasil."},
  {q:"Para defender a posse do territ√≥rio e gerar riqueza, os portugueses apostaram na:", options:["Produ√ß√£o de a√ß√∫car","Extra√ß√£o de sal","Planta√ß√£o de trigo","Pecu√°ria apenas"], answer:0, exp:"O a√ß√∫car virou a grande aposta at√© o ciclo do ouro."},
  {q:"Qual era a fun√ß√£o dos engenhos pr√≥ximos aos portos?", options:["Facilitar o escoamento do a√ß√∫car para a Europa","Evitar contato com rios","Esconder a produ√ß√£o","Produzir apenas para consumo local"], answer:0, exp:"Proximidade reduzia custo e tempo de transporte."},
  {q:"Quem eram os principais financiadores e comerciantes do a√ß√∫car na Europa por muito tempo?", options:["Holandeses","Italianos","Chineses","Suecos"], answer:0, exp:"Holandeses financiaram e distribu√≠ram o a√ß√∫car."},

  // 16-30 Uni√£o Ib√©rica / Brasil Holand√™s / Nassau
  {q:"A Uni√£o Ib√©rica uniu quais reinos sob o mesmo rei?", options:["Portugal e Espanha","Holanda e Inglaterra","Fran√ßa e It√°lia","Portugal e Inglaterra"], answer:0, exp:"Filipe II, rei da Espanha, tornou-se tamb√©m rei de Portugal (1580‚Äì1640)."},
  {q:"A Uni√£o Ib√©rica come√ßou ap√≥s a morte de:", options:["Dom Sebasti√£o e depois Dom Henrique","Dom Pedro I","Tiradentes","Maur√≠cio de Nassau"], answer:0, exp:"Ambos morreram sem herdeiros, abrindo disputa pelo trono."},
  {q:"As prov√≠ncias que se rebelaram e formaram as Prov√≠ncias Unidas eram:", options:["Pa√≠ses Baixos (Holanda)","It√°lia","R√∫ssia","Su√≠√ßa"], answer:0, exp:"Regi√£o dos atuais Pa√≠ses Baixos, com a Holanda em destaque."},
  {q:"Por que a Holanda invadiu o Brasil no s√©culo XVII?", options:["Para controlar o lucrativo neg√≥cio do a√ß√∫car","Para evangelizar povos ind√≠genas","Para procurar ouro em Minas","Para fugir do frio europeu"], answer:0, exp:"O a√ß√∫car era o grande neg√≥cio; a Holanda tinha sido impedida de comerciar."},
  {q:"Em 1624, os holandeses invadiram primeiro:", options:["Salvador (BA)","S√£o Vicente (SP)","Rio de Janeiro (RJ)","Bel√©m (PA)"], answer:0, exp:"A esquadra atacou Salvador, mas foi repelida depois."},
  {q:"Em 1630, conquistaram a regi√£o mais pr√≥spera do Brasil:", options:["Pernambuco","Amazonas","Goi√°s","Paran√°"], answer:0, exp:"A partir de 1630 consolidaram o chamado 'Brasil Holand√™s'."},
  {q:"A empresa que organizou a invas√£o foi a:", options:["Companhia das √çndias Ocidentais","Companhia de Jesus","Companhia do Com√©rcio do Sul","Companhia do Mate"], answer:0, exp:"Era uma grande companhia mercantil e militar holandesa."},
  {q:"Quem administrou o Brasil Holand√™s e modernizou Recife?", options:["Maur√≠cio de Nassau","Martim Afonso","Dom Jo√£o VI","Pombal"], answer:0, exp:"Nassau trouxe obras, cientistas e artistas."},
  {q:"Obra marcante do per√≠odo de Nassau:", options:["Pal√°cio de Friburgo","Teatro Amazonas","Pal√°cio de S√£o Crist√≥v√£o","Pal√°cio da Alvorada"], answer:0, exp:"Resid√™ncia oficial de Nassau em Recife."},
  {q:"Qual cidade virou capital do Brasil Holand√™s?", options:["Recife","Olinda","Salvador","Natal"], answer:0, exp:"Recife foi estruturada e elevou-se com canais, pontes e diques."},
  {q:"Nassau tamb√©m criou em Recife:", options:["Jardim bot√¢nico, zool√≥gico e observat√≥rio","Minas de carv√£o","F√°bricas de autom√≥veis","Universidade de Coimbra"], answer:0, exp:"Mostra o apre√ßo dele pelas ci√™ncias."},
  {q:"O termo 'Brasil Holand√™s' refere-se:", options:["√Ä parte do Nordeste sob dom√≠nio holand√™s (1630‚Äì1654)","A todo o Brasil sob a Holanda","√Ä Amaz√¥nia colonizada por holandeses no s√©culo XIX","Ao per√≠odo republicano"], answer:0, exp:"Especialmente Pernambuco e √°reas vizinhas."},
  {q:"Ap√≥s 1637, grande parte do litoral nordestino estava:", options:["Sob dom√≠nio da Holanda","Sob dom√≠nio franc√™s","Despovoado","Independente"], answer:0, exp:"Os holandeses expandiram ap√≥s conquistar Pernambuco."},
  {q:"Os refor√ßos que impediram o sucesso da invas√£o de 1624 foram enviados por:", options:["Coroa Ib√©rica","Fran√ßa","Inglaterra","Veneza"], answer:0, exp:"Portugal e Espanha estavam unidos (Coroa Ib√©rica)."},
  {q:"Os holandeses atuavam no Brasil principalmente como:", options:["Comerciantes e financiadores do a√ß√∫car","Exploradores de petr√≥leo","Ca√ßadores de baleia","Fabricantes de armas"], answer:0, exp:"Controlavam cr√©dito e distribui√ß√£o do a√ß√∫car na Europa."},

  // 31-45 Caminhos do Brasil: gado e bandeirantes
  {q:"Por muito tempo a ocupa√ß√£o do Brasil ocorreu principalmente:", options:["Perto do litoral","No interior amaz√¥nico","No extremo sul","No centro-oeste"], answer:0, exp:"Engenhos e portos estavam no litoral, facilitando o escoamento."},
  {q:"A cria√ß√£o de gado avan√ßou para:", options:["O interior do territ√≥rio","Apenas o litoral","Ilhas oce√¢nicas","Apenas cidades"], answer:0, exp:"Havia pouco espa√ßo nos engenhos; o gado foi para o interior."},
  {q:"Os bovinos chegaram ao Brasil vindos de:", options:["Cabo Verde","√çndia","M√©xico","Jap√£o"], answer:0, exp:"Os primeiros bois vieram de Cabo Verde."},
  {q:"Al√©m de alimento, o gado servia para:", options:["Transporte e for√ßa nas moendas","Produzir a√ß√∫car","Navegar barcos","Fazer p√≥lvora"], answer:0, exp:"Bovinos moviam rodas d‚Äô√°gua e transportavam cargas/pessoas."},
  {q:"Quem conduzia o gado por longas dist√¢ncias eram os:", options:["Tropeiros","Bandeirantes","Sesmeiros","Cors√°rios"], answer:0, exp:"Tropeiros abasteciam v√°rias regi√µes e fundaram cidades."},
  {q:"Cidades ligadas √†s rotas de tropeiros incluem:", options:["Vacaria, Lages, Castro e Sorocaba","Manaus, Bel√©m, Macap√°","Porto Seguro, Ilh√©us, Aracaju","Fortaleza, Teresina, S√£o Lu√≠s"], answer:0, exp:"Surgiram em pontos de parada e com√©rcio do gado."},
  {q:"Os habitantes de S√£o Vicente que faziam expedi√ß√µes ao interior eram chamados:", options:["Paulistas / Bandeirantes","Ga√∫chos","Garimpeiros","Bucaneiros"], answer:0, exp:"Paulistas organizavam as 'bandeiras'."},
  {q:"As 'bandeiras' usavam muito os rios, como:", options:["Tiet√™ e afluentes","S√£o Francisco e Tocantins apenas","Amazonas apenas","Paran√° apenas"], answer:0, exp:"Rios facilitavam a entrada para o interior."},
  {q:"A composi√ß√£o t√≠pica das bandeiras inclu√≠a:", options:["Europeus, ind√≠genas e seus descendentes","Somente portugueses nobres","Apenas militares espanh√≥is","Mission√°rios franceses"], answer:0, exp:"Era um grupo misto, com diferentes origens."},
  {q:"As bandeiras contribu√≠ram para:", options:["Ampliar o territ√≥rio al√©m de Tordesilhas","Dividir o Brasil entre Fran√ßa e Inglaterra","Encerrar a produ√ß√£o de a√ß√∫car","Proibir a cria√ß√£o de gado"], answer:0, exp:"Exploraram √°reas a oeste, ignorando Tordesilhas."},
  {q:"Tratado que dividia as terras entre Portugal e Espanha em 1494:", options:["Tratado de Tordesilhas","Tratado de Versalhes","Tratado de Petr√≥polis","Tratado de Madrid (1750)"], answer:0, exp:"As bandeiras frequentemente ignoraram seus limites."},
  {q:"Objetivo principal das primeiras bandeiras paulistas:", options:["Encontrar metais preciosos","Dominar o com√©rcio de escravos africanos no Atl√¢ntico","Cultivar caf√©","Fundar universidades"], answer:0, exp:"Buscavam ouro e pedras; s√≥ depois acharam grandes jazidas."},
  {q:"O 'Monumento √†s Bandeiras', em SP, foi criado por:", options:["Victor Brecheret","Aleijadinho","Debret","Tarsila do Amaral"], answer:0, exp:"Escultura ic√¥nica em frente ao Ibirapuera."},
  {q:"A descoberta de ouro em grande escala aconteceu:", options:["Ap√≥s cerca de um s√©culo de expedi√ß√µes","Na chegada de Cabral","No per√≠odo do Brasil Holand√™s","Apenas no Imp√©rio"], answer:0, exp:"Depois de longa busca, no fim do s√©c. XVII."},

  // 46-60 Ciclo do ouro, Conjura√ß√£o, Revolu√ß√£o Francesa, Napole√£o
  {q:"A principal nova riqueza do Brasil no fim do s√©c. XVII foi:", options:["Ouro","Caf√©","Borracha","Algod√£o"], answer:0, exp:"O ciclo do ouro substituiu o auge do a√ß√∫car."},
  {q:"O principal imposto nas regi√µes mineradoras era o:", options:["Quinto (20% do ouro)","D√≠zimo (10%)","Capita√ß√£o (50%)","Sisa (2%)"], answer:0, exp:"O quinto recolhia 1/5 de todo o ouro encontrado."},
  {q:"Para controlar a minera√ß√£o, a Coroa portuguesa:", options:["Criou postos e enviou ouvidores","Aboliu os impostos","Mudou a capital para Salvador","Proibiu o uso de estradas"], answer:0, exp:"Ouvidores cobravam e vigiavam entrada/sa√≠da de ouro."},
  {q:"A capital foi transferida de Salvador para o Rio de Janeiro porque:", options:["Ficava mais perto das minas","Tinha praias mais bonitas","Era mais antiga","Era sede da Igreja"], answer:0, exp:"Log√≠stica e fiscaliza√ß√£o do ouro."},
  {q:"Quando o ouro diminuiu e as metas n√£o eram atingidas, poderia ocorrer:", options:["Confisco de bens (derrama)","Anistia total","Redu√ß√£o autom√°tica de impostos","Mudan√ßa para Lisboa"], answer:0, exp:"A derrama permitia confiscar bens para cumprir a meta."},
  {q:"Movimento que buscou a independ√™ncia de Minas inspirado nos EUA:", options:["Conjura√ß√£o Mineira","Revolu√ß√£o Praieira","Sabinada","Balaiada"], answer:0, exp:"Planejou proclamar a independ√™ncia em Vila Rica."},
  {q:"L√≠der mais lembrado da Conjura√ß√£o Mineira:", options:["Tiradentes","Dom Pedro I","Jos√© Bonif√°cio","Maur√≠cio de Nassau"], answer:0, exp:"Joaquim Jos√© da Silva Xavier, o Tiradentes."},
  {q:"Quem traiu o grupo em troca de perd√£o de d√≠vidas?", options:["Joaquim Silv√©rio dos Reis","Dom Jo√£o VI","Pombal","Bonif√°cio"], answer:0, exp:"A dela√ß√£o levou √†s pris√µes; Tiradentes foi executado."},
  {q:"A Revolu√ß√£o Francesa come√ßou em:", options:["1789","1808","1500","1654"], answer:0, exp:"Derrubou a monarquia absolutista na Fran√ßa."},
  {q:"Um ideal associado √† Revolu√ß√£o Francesa:", options:["Liberdade, igualdade e fraternidade","Colonialismo sem impostos","Monarquia absoluta","Feudalismo"], answer:0, exp:"Inspirou muitos movimentos nas Am√©ricas."},
  {q:"Quem se destacou como general e depois imperador da Fran√ßa?", options:["Napole√£o Bonaparte","Lu√≠s XIV","Robespierre","Henrique VIII"], answer:0, exp:"Napole√£o expandiu o dom√≠nio franc√™s pela Europa."},
  {q:"Grande obst√°culo aos planos de Napole√£o na Europa:", options:["Inglaterra","Portugal","Su√©cia","Sardenha"], answer:0, exp:"A Inglaterra resistia e liderava coaliz√µes contra a Fran√ßa."},
  {q:"Napole√£o amea√ßou invadir pa√≠ses que:", options:["Comerciassem com a Inglaterra","Exportassem caf√©","Usassem ouro brasileiro","Falassem portugu√™s"], answer:0, exp:"Bloqueio Continental visava isolar os ingleses."},
  {q:"Portugal recusou romper com a Inglaterra; consequ√™ncia:", options:["Fuga da corte portuguesa para o Brasil (1807)","Independ√™ncia imediata do Brasil","Dom√≠nio holand√™s em Pernambuco","Fim dos engenhos"], answer:0, exp:"A corte transferiu-se para o Rio, mudando o status do Brasil."},
];

/* ====== Estado e UI ====== */
let index = 0;
let score = 0;
let locked = false;

const bar = document.getElementById('bar');
const qEl = document.getElementById('question');
const optEl = document.getElementById('options');
const feed = document.getElementById('feedback');
const counter = document.getElementById('counter');
const nextBtn = document.getElementById('nextBtn');
const scorePill = document.getElementById('scorePill');
const progressPill = document.getElementById('progressPill');
const endView = document.getElementById('end');
const qwrap = document.getElementById('qwrap');
const finalText = document.getElementById('finalText');

function shuffle(arr){ return arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(v=>v[1]); }

function render(){
  locked = false;
  nextBtn.disabled = true;
  feed.className = 'feedback'; feed.innerHTML = '';
  const total = QUESTIONS.length;
  const q = QUESTIONS[index];

  qEl.textContent = q.q;
  optEl.innerHTML = '';
  // Render options; keep order (4 op√ß√µes) para crian√ßas se localizarem, mas pode embaralhar se quiser:
  q.options.forEach((txt, i)=>{
    const b = document.createElement('button');
    b.className = 'btn';
    b.textContent = txt;
    b.onclick = ()=>select(i);
    optEl.appendChild(b);
  });

  progressPill.textContent = `${index+1} / ${total}`;
  bar.style.width = `${((index)/total)*100}%`;
  counter.textContent = `Quest√£o ${index+1} de ${total}`;
  scorePill.textContent = `${score} acerto${score===1?'':'s'}`;
}

function select(chosen){
  if(locked) return;
  locked = true;
  const q = QUESTIONS[index];
  const buttons = [...optEl.querySelectorAll('.btn')];
  buttons.forEach((b,i)=>{
    b.disabled = true;
    if(i === q.answer) b.classList.add('correct');
    if(i === chosen && i !== q.answer) b.classList.add('wrong');
  });

  const rightText = q.options[q.answer];
  if(chosen === q.answer){
    score++;
    scorePill.textContent = `${score} acerto${score===1?'':'s'}`;
    feed.className = 'feedback ok show';
    feed.innerHTML = `‚úÖ <div><strong>Mandou muito!</strong> Resposta certa.<br><span class="muted">${q.exp}</span></div>`;
  }else{
    feed.className = 'feedback no show';
    feed.innerHTML = `‚ùå <div><strong>Quase l√°!</strong> A correta √©: <em>${rightText}</em>.<br><span class="muted">${q.exp}</span></div>`;
  }
  nextBtn.disabled = false;
}

nextBtn.addEventListener('click', ()=>{
  if(index < QUESTIONS.length-1){
    index++;
    render();
  }else{
    finish();
  }
});

function finish(){
  // barra 100%
  bar.style.width = '100%';
  qwrap.style.display = 'none';
  endView.style.display = 'block';
  const total = QUESTIONS.length;
  const pct = Math.round((score/total)*100);
  let msg = 'Show!';
  if(pct >= 90) msg = 'Excelente! Voc√™ √© fera em Hist√≥ria! üèÜ';
  else if(pct >= 70) msg = 'Muito bom! Continue estudando. üí™';
  else if(pct >= 50) msg = 'Bom come√ßo! Que tal tentar mais uma vez? üôÇ';
  else msg = 'Tudo bem errar! Vamos treinar e melhorar. üöÄ';
  finalText.textContent = `${msg} Voc√™ acertou ${score} de ${total} (${pct}%).`;
}

function restart(){
  index = 0; score = 0; qwrap.style.display='block'; endView.style.display='none'; render();
}

function share(){
  const total = QUESTIONS.length;
  const pct = Math.round((score/total)*100);
  const text = `Fiz o Quiz de Hist√≥ria do Brasil (4¬∫ ano) e acertei ${score}/${total} (${pct}%)! üáßüá∑`;
  if(navigator.share){
    navigator.share({title:'Meu resultado no Quiz', text});
  }else{
    navigator.clipboard.writeText(text);
    alert('Resultado copiado! Cole onde quiser.');
  }
}

// inicializa
render();
</script>
</body>
</html>
